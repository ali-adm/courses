Введение в SQL
===

Данные могут быть мощным инструментом, но только если вы знаете, как ими пользоваться. В такой ситуации SQL незаменим! На этом курсе вы узнаете, как использовать стандартизированный язык баз данных SQL для доступа и манипулирования данными, хранящимися в базах данных. Когда вы научитесь использовать SQL, вы сможете работать в ведущих компаниях (и даже правительствах!), которые используют данные для прогнозирования и принятия

<a id="back"></a>
### Оглавление:

### [Начало работы](#begin)
#### [Работа с данными](#data_work)
#### [Выполнение Queries (запросов)](#queries)
#### [Реляционные базы данных](#rdb)
#### [Debugging (устранение ошибок)](#Debugging)
#### [Кассовые сборы (практика)](#kassa_practice)
#### [Контрольные вопросы к модулю 1](#exam_1)
### [Углубленное изучение](#deep_learning)
#### [Стандарты и лучшие практики](#standart_and_best_practic)
#### [Сортировка данных](#data_sorting)
#### [Заработная плата сотрудников (практика)](#payment)
#### [Ограничение данных](#data_limit)
#### [Меню (практика)](#menu_pract)
#### [Типы данных](#data_types)
#### [Теннисный турнир (практика)](#tennis_tourier)
#### [Фильтрация данных](#data_filter)
#### [Онлайн-книжный магазин (практикa)](#market_place)
#### [Контрольные вопросы к модулю 2](#exam_2)
### [Техники запросов](#technics_request)
#### [Поиск по шаблону](#pattern_search)
#### [Шоколад! (практика)](#chocolade)
#### [Расширенное сопоставление шаблонов](#advanced_pattern)
#### [Условия в SQL](#condition_sql)
#### [Выбери свою машину (практика)](#practis_car_select)
#### [Агрегация данных](#date_agregate)
#### [Смешиваем все вместе](#data_mix)
#### [Контрольные вопросы к модулю 3](#exam_3)
### [Анализ данных](#data_analise_h1)
#### [Анализ данных](#data_analise_h2)
#### [Группировка](#grouping)
#### [Посты в социальных сетях (практика)](#posting)
#### [Группировка и фильтрация](#grouping_filtering)
#### [Очистка данных](#data_clean)
#### [Данные о преподавателях (практика)](#data_about_teachers)
#### [Исправление типов данных](#data_type_correction)
#### [Понимание данных](#data_understand)
#### [Контрольные вопросы к модулю 4](#exam_4)


<a id="begin"></a>
Начало работы
===

### [Назад к оглавлению](#back)

<a id="data_work"></a>
Работа с данными
---

- **SQL** позволяет вам работать с данными, хранящимися в базе данных
- Запрос **SELECT** используется для получения данных из таблицы.

В этом курсе вы научитесь использовать **SQL** для работы с данными и принятия более умных решений. Давайте использовать **SQL-код** для доступа к информации о фильмах.

![sql query](https://lecontent.sololearn.com/material-images/214ad4f3fffd43b9b7d4706bcf58f545-ISQL1.1.03.png)

Выбор данных `year` из таблицы `movies`:
```sql
SELECT year FROM movies
```
Мы используем SQL-код для доступа к данным. Точно так-же из таблицы `movies` можно выбрать `title`:
```sql
SELECT title FROM movies
```
![movies table](https://lecontent.sololearn.com/material-images/0e2a835c8cf845438b05f9bdb2b286ad-sql3.png)

Данные находятся в базах данных. Практически каждая компания и организация полагаются на какую-либо форму базы данных для хранения и организации информации. **SQL** позволит вам взаимодействовать с данными, хранящимися в базе данных. 

**SQL-код** используется для отправки запросов к базе данных. Эти запросы называются так и называются - **запросы (queries)**.

![Record&Field](https://lecontent.sololearn.com/material-images/8a1aa66040d74383b466acd6a9da49f5-1.01.07.png)

Большинство баз данных собирают данные в таблицы. Таблицы организуют данные в:  
- строки **records (записи)**
- столбцы **fields (поля)**

![Record](https://lecontent.sololearn.com/material-images/d84524eb5f8a4f568ec5989ab765f53a-ISQL1.01.03.png)

**Record (строка)** содержит информацию о субъекте, таком как конкретный сотрудник, клиент или продукт, например фильм.

![Field](https://lecontent.sololearn.com/material-images/2c0a1e9c97cf4bd99ab763d8247d4066-SQL1.01.09.png)

**Field (столбец)** содержит информацию о субъектах, таких как имя, электронная почта или год выпуска продукта.

Например таблица **movies**, та что выше, содержит пять **record (строк)**, и три **field (столбца)**. 

![header](https://lecontent.sololearn.com/material-images/2c0a1e9c97cf4bd99ab763d8247d4066-SQL1.01.09.png)

Строка **header** - это **верхняя строка таблицы** и содержит названия разных полей (столбцов). (id, title, year - в табл. movies).

Команда **SELECT** используется для извлечения данных поля из таблицы.
```sql
SELECT year FROM movies
```

### [Назад к оглавлению](#back)


<a id="queries"></a>
Выполнение Queries (запросов)
---
- Данные могут быть классифицированы как **структурированные** или **неструктурированные**
- **SQL** используется для работы со **структурированными данными**.


Подумайте о своем любимом приложении или технологии. Вероятно, оно не смогло бы работать без данных. В этом уроке вы будете писать, тестировать и выполнять настоящий SQL-код.

Данные, которые могут быть сохранены в таблицах, называются **структурированными данными**.

**SQL** позволяет очень быстро и эффективно работать со структурированными данными. Одним **запросом - query** можно получить доступ к тысячам и тысячам записей в мгновение ока.

**Код Плейграунд**

Готовы написать, выполнить и протестировать настоящий код? Откройте **Код Плейграунд** для кода. Затем нажмите **"Run"**, чтобы получить запрошенные данные. В нашем случае мы просто будем приводить код для запуска здесь, и описывать его работу.
![movies table](https://lecontent.sololearn.com/material-images/168b347921c046e184db55e1d7675cd9-sql9.png)

Запрос к вышеприведенной таблице:
```sql
SELECT year FROM movies
```
Даст такой ответ:
> |year|
> |----|
> |1990|
> |1977|
> |1993|
> |2013|
> |2003|

Запрос к таблице - приводит к созданию меньшей таблицы с запрошенными данными.

**Реальные базы данных могут** содержать очень большое количество информации. **Query (Запрос)** - это способ получить только интересующие вас данные.

**Неструктурированные данные** - это информация, которую сложно хранить в таблицах.

**SQL** означает **Structured Query Language** (язык структурированных запросов). С помощью **SQL** вы сможете извлекать данные из массивных наборов данных с тысячами полей и записей. **SQL** используется для работы со структурированными данными в виде таблиц.

### [Назад к оглавлению](#back)


<a id="rdb"></a>
Реляционные базы данных
---

- **реляционные базы данных** хранят информацию в связанных таблицах
- **ключи** связывают таблицы в реляционной базе данных 
- вы можете запрашивать данные **FROM** (из) разных таблиц в базе данных

Компании и организации всех размеров и отраслей извлекают полезные идеи, связывая различные фрагменты связанных данных. На этом уроке вы узнаете, как связанные данные организованы в базах данных.

**Реляционная база данных** - самый распространенный тип базы данных. Как правило, реляционные базы данных состоят из нескольких взаимосвязанных таблиц.

Различные таблицы в реляционной базе данных связываются друг с другом с помощью полей (столбцов) с общими значениями. Эти поля называются ключами.
![key field](https://lecontent.sololearn.com/material-images/a51f8d8a65184b379a2356e0d09ed0c4-sql13.png)

Реляционная база данных хранит данные в **таблицах**, поэтому может обрабатывать только **структурированные данные**.

---

### Пример реляционной БД с двумя таблицами:
![example DB](https://lecontent.sololearn.com/material-images/26844f5c9cdc44cbbe05a036a7c765f3-ISQL.1.03.05.png)

- таблицы в базе данных: **2**
- записи в таблице фильмов: **5**
- поля в таблице студий: **3**

**Ключевые поля** используются для связи таблиц в реляционной базе данных. В примере: поле **studio_id** в таблице **movies** используется для связи с таблицей **studios**.

Различные таблицы в реляционной базе данных имеют уникальные имена. Имя таблицы, **FROM** (откуда) вы хотите получить данные, должно быть включено в **SQL-запрос**:
```sql
SELECT year_founded FROM studios
```
Запрос к таблице - приводит к созданию меньшей таблицы с запрошенными данными:
> |year_founded|
> |----|
> |1971|
> |1912|
> |1923|
> |2035|

Вам нужно убедиться, что вы извлекаете поля из правильной таблицы. Например **SQL query** для получения названия студий:
```sql
SELECT name FROM studios
```
> |name        |
> |-------------|
> |Lucasfilm    |
> |Universal Pictures|
> |Walt Disney  |
> |20th Century Fox|

---

### Пример реляционной БД с тремя таблицами:

![Пример реляционной БД с тремя таблицами](https://lecontent.sololearn.com/material-images/4c829ee180564ae3bc116dd65b0be4ba-1.03.09.png)

Используя ключевые поля этих таблиц, можно узнать, какой товар заказал каждый клиент:
- **John: T-shirt**
- **Jane: Hoodie**
---

Возможно, вы уже использовали таблицы, такие как **Excel**, для работы с данными раньше. Базы данных лучше подходят для хранения больших и более сложных наборов данных.  Инструмент, в зависимости от ситуации:
- Работа с данными в одной таблице: **Таблица** 
- Работа с данными в нескольких, крупных таблицах: **База данных** 

Вы можете выбрать несколько полей из одной таблицы одновременно, разделяя их запятыми.
```sql
SELECT title, year FROM movies
```
```sql
SELECT name, price FROM products
```

### [Назад к оглавлению](#back)


<a id="Debugging"></a>
Debugging (устранение ошибок)
---

- **Ошибки в запросах** вызывают сообщения об ошибке
- **Схема базы данных** помогает избежать ошибок
- SQL queries организованы **на разных строках**, чтобы их было легче читать людям

Базы данных не поймут ваши **queries (запросы)**, если ваш SQL-код содержит ошибки, и они вернут сообщение об ошибке. Ошибки в компьютерном коде называются **bugs (баги)**, и вы научитесь идентифицировать и исправлять ошибки в этом уроке.

Если ваш **SQL query** содержит ошибку, вы не сможете получить доступ к данным. Следующий **SQL-код** содержит **bug**:
```sql
SELECT title FROM
```
Если его запустить, то появится сообщение об ошибке:
```sql
CREATE TABLE

INSERT 0 5

ERROR:  syntax error at end of input
        FROM
```

Ошибка заключается в том, что после `FROM` нужно указать имя таблицы `movies`.

Опытные специалисты по данным постоянно сталкиваются с ошибками. Так что если вы делаете ошибки, это нормально! Вы на правильном пути.

Даже неправильно написанные слова и опечатки могут вызывать ошибки. Например:
```sql
SELECT title FROM movi es
```
```sql
ERROR:  relation "movi" does not exist
        FROM movi es
```

Знание того, как данные организованы в базе данных, поможет вам сократить ошибки.
![Database Schema](https://lecontent.sololearn.com/material-images/3a67187995c2406c95bedb5d4581ea50-1.04.05.png)

**Схема (Database Schema)** - это визуальное представление организации базы данных, показывающее ее таблицы, поля и ключи. Стрелки используются для показа связей между различными таблицами.

В представленной выже схеме:
- таблицы в базе данных: **2**
- поля в таблице movies: **4**
- поля в таблице studios: **3**

Схема помогает запускать запросы без ошибок.
```sql
SELECT title FROM movies
```
Схема показывает поля, которые содержит таблица. Она не показывает значения данных.
![schema](https://lecontent.sololearn.com/material-images/890677aeaa74439a9fb9258cc99c451f-1.04.9.png)

Например выбор всех полей из таблицы `departments`:
```sql
SELECT id, name FROM departments
```
Символ `*` позволяет выбрать все поля в таблице. Таким образом, вы можете избежать опечаток при перечислении имен полей.
```sql
SELECT * FROM departments
```
Переносы строк не нужны для выполнения ваших queries без ошибок. Организация запроса на разные строки делает код более читабельным для людей.
```sql
SELECT title 
FROM movies
```
Организация запроса на несколько строк облегчает его чтение, но важно помнить, что командные слова и имена полей не могут быть разделены.
```sql
SELECT ti tle
FR
OM movies
```
```sql
ERROR:  syntax error at or near "FR"
        FR
        ^
```

### [Назад к оглавлению](#back)


<a id="kassa_practice"></a>
Кассовые сборы (практика)
---

Время для практики!

Оцените ваши навыки программирования, решая задачи, как это делают профессионалы! Это весело и увлекательно.

ПРАКТИЧЕСКОЕ УПРАЖНЕНИЕ

Представьте, что вы хотите исследовать кассовые сборы фильмов, и вам предоставлена следующая таблицa:
![table](https://lecontent.sololearn.com/material-images/d879ff48f00e40aabf28515fb7a4721b-3b230107a2c54e4eaf291703a6c6b9ae-cc4.png)
Завершите предоставленный запрос для извлечения данных поля `revenue` из таблицы:
```sql
SELECT revenue
FROM movies
```

### [Назад к оглавлению](#back)


<a id="exam_1"></a>
Контрольные вопросы к модулю 1
---

```sql
1.
Термин для запроса информации из базы данных - это...

[x] query (запрос)
[] функция
[] атрибут
```
```sql
2.
Завершите SQL query

SELECT name FROM products
```
```sql
3.
Что вернет этот SQL-запрос?

SELECT country FROM clients

[] Данные о стране для первой записи в таблице clients
[x] Данные о стране для всех записей в таблице clients
```
```sql
4.
Сопоставьте термин с определением

Ошибка в коде: bug
Запрос информации: query
Визуальное представление базы данных: schema
```
```sql
5.
Реляционная база данных хранит информацию в...

[] HTML-документах
[] файлах Excel
[x] таблицах
```
```sql
6.
Что связывает различные таблицы в реляционной базе данных?

[] типы данных
[x] общие ключевые поля
[] имена таблиц
```
```sql
7.
Завершите query

SELECT id, date FROM orders
```
```sql
8.
Этот query вызывает ошибку. Почему?

SELECT year

[] Отсутствует запятая в конце
[x] query неполный
```
```sql
9.
Завершите SQL query для извлечения всех полей из таблицы songs

SELECT * FROM songs
```

10.
![schema](https://lecontent.sololearn.com/material-images/df2b93cf9a004ff18d73b770fcaa8d1b-1.03.09.png)

```sql
Выберите ключевое поле в таблице orders, которое связывается с таблицей customers

[] product_id
[] date
[x] customer_id
```
```sql
11.
Объясните, что делает SQL-код

SELECT name, age
FROM users

[] Извлекает name users из таблицы age
[] Заменяет поле name данными из поля age
[x] Извлекает поля name и age из таблицы users
```
```sql
12.
Завершите запрос для извлечения titles всех записей в таблице movies.

SELECT title FROM movies
```
```sql
13.
Завершите запрос для извлечения всех полей из таблицы flights.

SELECT * FROM flights
```

### [Назад к оглавлению](#back)


<a id="deep_learning"></a>
Углубленное изучение
===

<a id="standart_and_best_practic"></a>
Стандарты и лучшие практики
---

- Вы можете добавлять **комментарии** к своему коду с помощью **двойного дефиса (--)**
- Вы можете добавить **блочный комментарий** с помощью **`/* ... */`**
- SQL - это **регистронезависимый** язык

Для более эффективного сотрудничества важно писать код, который легко понять другим. В этом уроке вы изучите некоторые лучшие практики, которые помогут вам написать эффективные и читаемые SQL-запросы.

Для объяснения своих SQL-запросов специалисты по данным используют **комментарии**. Добавление комментария осуществляется с помощью **двойного дефиса** (`--`):
```sql
-- extracts movie titles
SELECT title FROM movies
```

Комментарии помогут другим (и будущему вам!) понять код. Комментарии не являются инструкциями, они игнорируются компьютером.
```sql
-- extracts 2 product fields
SELECT name, price FROM product
```

Комментарии несут функцию **объяснения кода для людей**, их использование является **хорошей практикой**. Вы можете использовать комментарии, чтобы временно отключить запрос или часть запроса при тестировании вашего кода. Таким образом, компьютер пропустит эту инструкцию.

Например следующий код выдаст сообщение об ошибке, т.к. компьютер проигнорирует первую строку:
```sql
--SELECT *
FROM movies
```

А следующий код вообще ничего не выдаст, т.к. все закоментировано:
```sql
-- SELECT age
-- FROM students
```

Если вам нужно сделать комментарии с несколькими строками, вы можете использовать блочные комментарии `/* ... */`.
```sql
/*
This query selects the address and phone number fields
*/
SELECT address, phone FROM customers
```

**SQL-код нечувствителен к регистру** для командных слов, таких как `SELECT` и `FROM`. Код ниже будет выполняться без ошибок:
```sql
select title from movies
```

Специалисты по данным используют: 
- **заглавные буквы** для командных слов SQL, и 
- **строчные буквы** для имен таблиц и полей. 

Это делает код SQL более читаемым и последовательным в различных проектах. Следующий **query**, следует лучшим практикам:
```sql
--Extracts all fields
SELECT *
FROM movies
```
Вы уже знаете, что переносы строк игнорируются компьютером. То же самое происходит с дополнительными пробелами. Следующий код - будет работать:
```sql
SELECT title                 FROM
     movies
```

### [Назад к оглавлению](#back)


<a id="data_sorting"></a>
Сортировка данных
---

- Вы можете сортировать извлеченные данные с помощью команды `ORDER BY`
- `DESC` **сортирует** данные в порядке убывания (от наибольшего к наименьшему или **от Z до A**)
- `ASC` **сортирует** данные в порядке возрастания (от наименьшего до наибольшего или **от A до Z**)

Музыкальные стриминговые сервисы, такие как Spotify и Apple Music, сортируют песни и плейлисты на основе истории и предпочтений пользователя. На этом уроке вы узнаете, как сортировать данные с помощью SQL.

Сортировка заключается в размещении данных в осмысленном порядке. Команда `ORDER BY` используется для сортировки извлеченных данных в таблице результатов. Данные сортируются по полям. Запрос для сортировки таблицы `movies` по полю `year` будет выглядеть:
```sql
SELECT * FROM movies ORDER BY year
```

По умолчанию команда `ORDER BY` сортирует данные в порядке возрастания. Это означает, что записи в таблице результатов будут упорядочены от наименьшего до наибольшего года. Вывод приведенного выше примера - будет следующим:

>CREATE TABLE
>
>INSERT 0.5
>| i |	title |	year |
>|---|---------|------|
>| 2 |Star Wars |	1977 |
>| 1 |Home Alone	| 1990 |
>| 3 |Jurassic Park |	1993 |
>| 5 |Pirates of the Caribbean |	2003 |
>| 4 |Frozen |	2013 |
>5 rows

В следующем примере извлеченные данные в таблице результатов будут отсортированы по цене:
```sql
SELECT name, price
FROM products
ORDER BY price
```

Извлеченные данные по умолчанию сортируются в порядке возрастания. Если вам нужно отсортировать данные в порядке убывания (от наибольшего к наименьшему), вам нужно добавить ключевое слово `DESC`:
```sql
SELECT *
FROM customers
ORDER BY age DESC
```

По умолчанию данные сортируются в порядке возрастания. Вы можете использовать явное ключевое слово `ASC`, чтобы сделать ваши запросы более читаемыми, особенно при написании сложных запросов.

Следующий запрос - явный для читателя, таблица результатов отсортирована в порядке возрастания:
```sql
SELECT *
FROM customers
ORDER BY age ASC
```
Записи в следующих таблицах были отсортированы по году:

![asc_dest](https://lecontent.sololearn.com/material-images/4174581c08aa43848c13e1ec114df798-2.02.09.png)

- Table 1: **ASC**
- Table 2: **DESC** 

Вы также можете сортировать данные по полю, содержащему текст. По умолчанию текст сортируется в алфавитном порядке.
- ant, cat, dog: **ASC**
- dog, cat, ant: **DESC**

В следующем примере: данные студента, с наивысшей оценкой вверху.
```sql
SELECT name, grade, avg_mark
FROM students
ORDER BY grade DESC
```

### [Назад к оглавлению](#back)


<a id="payment"></a>
Заработная плата сотрудников (практика)
---

Время для практики!

Оцените ваши навыки программирования, решая задачи, как это делают профессионалы! Это весело и увлекательно.

ПРАКТИЧЕСКОЕ УПРАЖНЕНИЕ

Представьте, что вы - менеджер по персоналу, который хочет отсортировать записи о сотрудниках по их зарплатам.
![employeers](https://lecontent.sololearn.com/material-images/202d76987873481e9a14cf3138a5f70b-b2a263e9a4d04a5da78aa89698ca2318-cc6.png)

Завершите запрос для выбора всех полей из таблицы и сортировки результатов в порядке убывания на основе поля `salary`.
```sql
-- сортировка по зарплатам в порядке убывания
SELECT * 
FROM employees
ORDER BY salary DESC
```

### [Назад к оглавлению](#back)


<a id="data_limit"></a>
Ограничение данных
---

- **LIMIT** используется для уменьшения количества записей в таблице результатов
- **OFFSET** пропускает определенное количество записей
- **ORDER BY** может быть объединен с **LIMIT** и **OFFSET**

Разделение больших наборов данных на более маленькие части ускоряет время загрузки и помогает показывать людям только то, что им нужно. На этом уроке вы узнаете, как контролировать количество извлекаемых записей из базы данных.

![movies](https://lecontent.sololearn.com/material-images/2b09cd6115df48538d6e6c92d74f2cf5-ISQL1.01.03.png)

```sql
SELECT * FROM movies
```
Запрос извлечет пять записей.

Ключевое слово `LIMIT` извлекает ограниченное количество записей. Следующий SQL-запрос извлечет первые десять записей:
```sql
SELECT * FROM employees LIMIT 10
```

Команда `LIMIT` уменьшает количество записей в таблице результатов. Если в таблице содержится пять записей, а запрос содержит `LIMIT 10` - то будут извлечены пять записей.

Если в таблице содержится 1000 записей, то следующий запрос все равно извлечет первые десять записей.:
```sql
SELECT * FROM products LIMIT 10
```

`LIMIT` обычно используется совместно с `ORDER BY` для извлечения записей с наибольшим/наименьшим рейтингом.

Следующий запрос выберет 10 самых дорогих товаров:
```sql
SELECT *
FROM products
ORDER BY price DESC
LIMIT 10
```

`LIMIT` применяется как последняя операция. Сначала результаты будут отсортированы, а затем ограничены.

Следующий запрос извлечет пять записей с наименьшими ценами:
```sql
SELECT *
FROM products
ORDER BY price ASC
LIMIT 5
```

Параметр `OFFSET` используется с `LIMIT` для пропуска определенного количества записей.

![movies](https://lecontent.sololearn.com/material-images/d7120b3b2d334150bc30a0685796f1c4-2.03.11.png)

Можно изменить число `OFFSET`, чтобы увидеть эффект на таблице результатов:
```sql
/* OFFSET 2 пропустит первые 2 строки
и начнет извлекать с 3-й записи*/

SELECT title
FROM movies
LIMIT 3 OFFSET 2
```
Вывод запроса:
> CREATE TABLE
> 
> INSERT 0 5
> 
> |title|
> |-----|
> |Jurassic Park|
> |Frozen|
> |Pirates of the Caribbean|
> |(3 rows)|

В следующем примере - будет извлечен один заголовок: `Star Wars`.

![movies](https://lecontent.sololearn.com/material-images/56767fa21a924eec927a6a6523631fd3-2.03.12.png)
```sql
SELECT title
FROM movies
LIMIT 1 OFFSET 1
```

Следующий запрос извлечет заголовки первых трех фильмов:
```sql
SELECT title
FROM movies
LIMIT 3
```

Если в таблице movies содержится пять записей, следующий запрос извлечет четыре, пропустив первую:
```sql
SELECT *
FROM movies
LIMIT 4 OFFSET 1
```

С помощью следующего запроса будут извлечены `New York` и `London` (их id 101 и 102):

![sities](https://lecontent.sololearn.com/material-images/45e10b3e3f51474c8d5fd6469eb23446-2.03.15.png)

```sql
SELECT name
FROM cities
LIMIT 2 OFFSET 100
```

### [Назад к оглавлению](#back)


<a id="menu_pract"></a>
Меню (практика)
---

Время для практики!

Оцените ваши навыки программирования, решая задачи, как это делают профессионалы! Это весело и увлекательно.

ПРАКТИЧЕСКОЕ УПРАЖНЕНИЕ

Представьте, что вы разрабатываете мобильное приложение для ресторана, и вы хотите показать только четыре блюда на первой странице меню.

У вас есть следующая таблица с menu:

![menu](https://lecontent.sololearn.com/material-images/6b1ec041cdef4320a6ef64b7072ce589-2ce03a53cf51422fbd4572c1e6b41efd-cc7.png)

Напишите запрос для выбора всех полей первых четырех позиций из таблицы menu.
```sql
-- извлечь первые 4 записи
SELECT * FROM menu
LIMIT 4
```

### [Назад к оглавлению](#back)


<a id="data_types"></a>
Типы данных
---

- Значения могут иметь различные типы данных
- Строка - это тип данных для текстовых значений
- Вы можете выполнять вычисления с значениями в числовых полях

Данные имеют различные формы и типы. Компьютеры обрабатывают разные типы данных по-разному. В этом уроке вы начнете работать с различными типами данных.

![data_type](https://lecontent.sololearn.com/material-images/98617158bba04200b8f8ab6b4a95abb5-2.03.12.png)

Таблица данных заполнена значениями. Существуют различные типы значений:
- Поле `title` содержит: **текстовые значения**
- Поле `year` содержит: **числовые значения**

Когда данные представлены в виде **чисел**, вы можете выполнять вычисления с этими значениями.

![sales](https://lecontent.sololearn.com/material-images/4323c16a912c4d198b9999f3afe222e4-2.04.03.png)

Вы можете включать вычисления в таблицу результатов:
```sql
/*
Оператор сложения +
*/
SELECT name, price+delivery AS TOTAL
FROM sales
```
> CREATE TABLE
> 
> INSERT 0 4
> |name|	total|
> |----|----|
> |pen|	15|
> |eraser|	16|
> |marker|	24|
> |pencil|	7|
> |(4 rows)|

Вы можете дать столбцам временное имя (или псевдоним) с помощью ключевого слова `AS`. Следующий запрос демонстрирует такой заголовок таблицы результатов:
```sql
/*
Оператор умножения *
*/
SELECT name, price*delivery AS multiplication
FROM sales
```
> CREAT TABLE
> 
> INSERT 0 4
> |name|	multiplication|
> |------|------|
> |pen|	50|
> |eraser|	15|
> |marker|	80|
> |pencil|	10|
> |(4 rows)|

Запрос,

```sql
SELECT name, price * delivery
FROM sales
```
 к таблице данных ниже - 
 
![sales](https://lecontent.sololearn.com/material-images/a9e17affe9c440daa6b8a4a60da74cdf-2.04.03.png)

выполнит четыре вычисления.

Таблица, полученная с помощью запроса:
```sql
SELECT name, price, price+delivery
FROM sales
```
будет содержать три стобца.

Компьютеры обрабатывают разные типы информации по-разному. Вы не сможете выполнять математические вычисления с полями, содержащими текстовые значения. Код вызовет ошибкy:
```sql
SELECT name, name+price
FROM sales
```
> CREATE TABLE
> 
> INSERT 0 4
> 
> ERROR:  operator does not exist: character varying + integer
>         SELECT name, name+price

**Текстовое поле**, это **столбец данных** с текстовыми значениями.

Технически текстовые данные называются строками. Операцией, которую можно выполнять со строками, является конкатенация. **Конкатенация объединяет строки**. Таблица результатов в примере ниже демонстрирует конкатенацию:

![employees](https://lecontent.sololearn.com/material-images/1f7d974dd85a4e378ecd6d812f451b9d-2.04.11.png)
```sql
SELECT CONCAT(first_name, last_name) AS full_name
FROM employees
```
> CREATE TABLE
> 
> INSERT 0 3
> 
> |full_name|
> |---------|
> |JohnDoe|
> |JaneSmith|
> |AliceJohnson|
> |(3 rows)|

### [Назад к оглавлению](#back)


<a id="tennis_tourier"></a>
Теннисный турнир (практика)
---

ПРАКТИЧЕСКОЕ УПРАЖНЕНИЕ

Вы организуете теннисный турнир с несколькими матчами. Каждый матч состоит из трех партий, и игроки зарабатывают очки в каждой партии. У вас есть следующая таблица с матчами `matches`:

![matches](https://lecontent.sololearn.com/material-images/19afdd6a4db140b883d77b30bff5d6be-e346a50637364b918ea0b32a15e88de8-draftcc8.png)

Напишите запрос для выбора имен игроков и общего количества очков в поле "Total".
```sql
-- выбрать имена игроков и общее количество очков как Total
SELECT player_name, set_1 + set_2 + set_3 AS Total
FROM matches
```

### [Назад к оглавлению](#back)


<a id="data_filter"></a>
Фильтрация данных
---

- **WHERE** используется для фильтрации данных на основе определенных условий
- Для создания разных условий необходимы **операции сравнения**
- Строковые значения в SQL-коде должны быть окружены **кавычками**

Базы данных могут содержать большое количество данных. Скорее всего, вы не хотите видеть все сразу. В этом уроке вы узнаете, как фильтровать данные, которые соответствуют условию.

`WHERE` используется для извлечения записей, которые соответствуют условию. Следующий запрос, показывает как извлечь записи о студии с именем `'Walt Disney'`. При обращении к строковым значениям в SQL-коде необходимо использовать одинарные кавычки вокруг текста.:
```sql
SELECT * 
FROM studio
WHERE name = 'Walt Disney'
````

> CREATE TABLE
> 
> INSERT 0 4
> 
> | id | name | year_founded |
> |----|------|--------------| 
> | 3 | Walt Disney | 1923 |
> (1 row) 

Как мы узнаем, что `'Walt Disney'` - это строка? - Код показывает текст, окруженный кавычками. Отсутствие кавычек в строках приведет к ошибкам. Следующий код это демострирует:
```sql
SELECT *
FROM studio
WHERE name = Walt Disney
```

> CREATE TABLE
> 
> INSERT 0 4
> 
> ERROR:  syntax error at or near "Disney"
>         WHERE name = Walt Disney
---
Вы также можете создавать условия для фильтрации с числовыми значениями:

![movies](https://lecontent.sololearn.com/material-images/52c70197bef34e358169ef4913a3c3f4-2.05.05.png)

Выделенные записи соответствуют условию `year > 2000`.

Вы можете использовать операции сравнения для доступа к данным, которые соответствуют условию. Операция сравнения всегда приводит к одному из двух результатов: **Да** (`True`) или **Нет** (`False`).

`50 > 100` - 50 больше 100?

Нет (ложь) = `False`

---
![movies](https://lecontent.sololearn.com/material-images/2ea709c072d84a768175daf22fb32885-ISQL1.01.03.png)

`Frozen` - соответствует условию `year > 2010`.

---
Запрос ниже извлекает фильмы, выпущенные после 2000 года
```sql
SELECT title
FROM movies
WHERE year > 2000
```

Условие, которое мы используем для фильтрации записей, следует после `WHERE`. Будут извлечены только записи, которые делают условие истинным (`true`).
```sql
SELECT title
FROM movies
WHERE year < 1990
```

Условия включают операторы сравнения:
- equal to `=`
- greater than `>` 
- less than `<`

В качесте примера запрос, фильтрующий песни, длина которых превышает три минуты:
```sql
SELECT *
FROM songs
WHERE length > 3
```

Фильтрация книг, которые были опубликованы в 2023 году:
```sql
SELECT titles
FROM books
WHERE year = 2023
```

Не забывайте, что строковые параметры в запросах - должны быть окружены кавычками. Фильтрация книг в категории novel:
```sql
SELECT title
FROM books
WHERE category = 'novel'
```

Еще запрос, фильтрующий продукты с ценой меньше 100:
```sql
SELECT *
FROM products
WHERE price < 100
```

### [Назад к оглавлению](#back)


<a id="market_place"></a>
Онлайн-книжный магазин (практикa)
---

ПРАКТИЧЕСКОЕ УПРАЖНЕНИЕ

Вы работаете в качестве аналитика данных для онлайн-книжного магазина. У вас есть следующая таблица с книгами:

![books](https://lecontent.sololearn.com/material-images/ed118b32c9024c6288ad4cdfb101fdbf-76433a454b32455a851dfd194d1552d7-draftcc9.png)

Напишите запрос для выбора всех полей из таблицы `"books"`, но только для книг, принадлежащих к жанру `'Fiction'`.
```sql
-- выбрать все поля, фильтровать по жанру 'Fiction'
SELECT *
FROM books
WHERE genre = 'Fiction'
```

### [Назад к оглавлению](#back)


<a id="exam_2"></a>
Контрольные вопросы к модулю 2
---

```sql
1.
Какая команда SQL используется для сортировки извлеченных данных?

[x] ORDER BY
[] WHERE
[] SORT
```
```sql
2.
По умолчанию команда ORDER BY сортирует данные в ...

[x] возрастающем порядке
[] убывающем порядке
[] случайном порядке
```
```sql
3.
Какое ключевое слово используется для сортировки данных от большего к меньшему или от Z до A?

[x] DESC
[] ASC
[] DOWN
```
```sql
4.
Какова цель ключевого слова LIMIT?

[] Конкатенация строк
[x] Сокращение количества извлеченных записей
[] Сортировка данных
```
```sql
5.
Какая правильная последовательность при использовании ORDER BY и LIMIT вместе?

[x] Сначала сортировка, затем ограничение
[] Сначала ограничение, затем сортировка
```
```sql
6.
Какое ключевое слово используется для фильтрации данных на основе определенных условий?

[] IF
[x] WHERE
[] FILTER
```
```sql
7. 
Сколько полей будет содержать таблица результатов после выполнения этого запроса?

SELECT name, price, price + delivery
FROM sales
WHERE id > 3

[] 2
[] 1
[x] 3
```
```sql
8.
Завершите запрос для извлечения 5 самых дорогих товаров.

SELECT *
FROM products
ORDER BY price DESC
LIMIT 5
```
```sql
9.
Завершите запрос для извлечения книг с рейтингом выше 7.

SELECT *
FROM books
WHERE rating > 7
```
```sql
10.
Извлеките имена студентов, чья страна - 'USA'

SELECT name
FROM students
WHERE country = 'USA'
```
```sql
11.
Извлеките сотрудников, у которых менее 5 лет опыта

SELECT *
FROM employees
WHERE experience < 5
```
```sql
12.
Завершите запрос для извлечения имен и электронных адресов пользователей, которые в настоящее время активны

SELECT name, email
FROM users
WHERE status = 'active'
```

### [Назад к оглавлению](#back)


<a id="technics_request"></a>
Техники запросов
===

<a id="pattern_search"></a>
Поиск по шаблону
---

- **LIKE** используется для поиска шаблонов в строковых полях
- Шаблоны **LIKE** чувствительны к регистру
- Когда строковое поле содержит числа, они рассматриваются как символы

Вы можете автоматизировать ручные и утомительные задачи с помощью кода. Это может быть особенно полезно в таких областях, как маркетинг и финансы. В этом уроке вы узнаете, как находить определенные шаблоны в данных, чтобы ускорить задачи и освободить время.

Запрос для фильтрации записей студии с именем 'Walt Disney':
```sql
SELECT *
FROM studios
WHERE name = 'Walt Disney'
```

Запрос по имени фильма:
```sql
SELECT *
FROM movies
WHERE title = 'Frozen'
```

Строковые значения в SQL-коде должны быть заключены в одинарные кавычки.

В следующем примере, ни одного комикса не будет извлечено:

![comics](https://lecontent.sololearn.com/material-images/f7ae3771bfd844b8a834d9cac04ccda7-3.01.05.png)
```sql
SELECT *
FROM comics
WHERE title = 'The Avengers'
```
> ERROR:  type "title" does not exist
>         WHERE title 'The Avengers'

Ключевое слово **LIKE** используется с командой **WHERE** для поиска шаблонов в строковых значениях. Символ **%** может заменить любое количество символов (один, несколько или ни одного) в строке, чтобы создать шаблоны.
```sql
SELECT *
FROM comics
WHERE title LIKE 'The Avengers%'
```
> CREATE TABLE
> 
> INSERT 0 3
> 
> |title|
> |-----|
> |The Avengers: Celestial Quest|
> |The Avengers: Citizen Kang|
> |The Avengers: Infinity Classic|
> (3 rows)

Специальный символ `%` известен как подстановочный знак и используется для создания шаблонов. Например `r.simpsons@gmail.com` будет соответсвовать шаблону `'%gmail.com'`

`LIKE` используется для фильтрации строк, поэтому вы должны заключить шаблон в одинарные кавычки `' '`:
```sql
SELECT email
FROM users
WHERE email LIKE '%gmail.com'
```

Подстановочный знак % может использоваться в любой части шаблона и столько раз, сколько необходимо. Пример извлечения всех названий, содержащих слово `Avengers`:
```sql
SELECT *
FROM comics
WHERE title LIKE '%Avengers%'
```

Например `'A%'` следует использовать, чтобы соответствовать только строкам, начинающимся с символа `'A'`.

Шаблоны с оператором `LIKE` чувствительны к регистру в большинстве систем баз данных. Это означает, что шаблон будет рассматривать прописные и строчные символы как разные.
```sql
/* Этот запрос ничего не вернет
потому что названия начинаются с 'The'*/
SELECT *
FROM comics
WHERE title LIKE 'the Avengers%'
```
> CREATE TABLE
> 
> INSERT 0 3
> 
> |id|	title|	year|
> |---|---|---|
> (0 rows)
```sql
/* Запрос исправлен на 'The'*/
SELECT *
FROM comics
WHERE title LIKE 'The Avengers%'
```
> CREATE TABLE
> 
> INSERT 0 3
> 
> |id|	title|	year|
> |--|---|---|
> |1|The Avengers: Celestial Quest|	2012
> |2|The Avengers: Citizen Kang|	2011
> |3|The Avengers: Infinity Classic|	2013
> (3 rows)

Символ `%` означает любое количество символов, включая ноль символов. Например шаблон `'%fee%'` соответствует значениям `'service fee'` и `'fee refund'`.

`LIKE` используется для поиска шаблонов в строковых полях. Когда числа являются частью строки, их также можно сопоставлять с шаблонами.

Например в следующем запросе, будет извлечена первая запись:

![comics](https://lecontent.sololearn.com/material-images/4461dfa0c5854939a6a4b9cc831d7ed8-3.01.16.png)
```sql
SELECT *
FROM comics
WHERE title LIKE 'Spider-Man 2%'
```

Например стороки:
- `Package 10E: Бизнес план`
- `Package AD1: Промежуточный план` 

Соответствуют шаблону `'Package%1%'`.

### [Назад к оглавлению](#back)


<a id="chocolade"></a>
Шоколад! (практика)
---

ПРАКТИЧЕСКОЕ УПРАЖНЕНИЕ

Ресторан разрабатывает новое меню десертов и хочет выделить десерты с названиями, включающими слово `'шоколад'`. Дана следующая таблица `desserts`:

![desserts](https://lecontent.sololearn.com/material-images/0ad4e9667ec049fabf7504359c7e1625-f129f03a8610428a924ba36c1e2842ce-draftcc11.png)

Напишите запрос для выбора `name` десерта и `price` из таблицы `desserts`, где название десерта содержит слово `'chocolate'`.
```sql
/*
выбрать name десерта и price
где название содержит 'chocolate''
*/

SELECT name, price
FROM desserts
WHERE name LIKE '%chocolate%'
```

### [Назад к оглавлению](#back)


<a id="advanced_pattern"></a>
Расширенное сопоставление шаблонов
---

- символ **подстановки подчеркивания** `_` представляет любой одиночный символ в шаблоне
- Вы можете использовать команды `UPPER()` и `LOWER()` для выполнения **поиска шаблонов без учета регистра**

В этом уроке вы узнаете различные техники, которые помогут улучшить ваши навыки сопоставления шаблонов и сделать ваши запросы более эффективными.

Строка `Digital marketing` - соответствует шаблону `'%marketing'`.

запрос для извлечения твитов, содержащих хэштег `'#DigitalMarketing'`:
```sql
SELECT *
FROM tweets
WHERE content
LIKE '%#DigitalMarketing%'
```

Название отеля Alpine Summit Lodge - соответствует шаблону `'A%S%'`

Продукты `A154B` и `A8B45` - будут извлечены при запросе:
```sql
SELECT * 
FROM products 
WHERE product_code LIKE 'A%B%'
```

Символ подчеркивания `_` является еще одним символом подстановки и представляет только один символ. `A4B8` - будет соответствовать шаблону `'A_B8'`. `A4B8`, `A8B5` - соответствуют шаблону `'A_B_'`

Символы подстановки, такие как `%` и `_`, используются для поиска шаблонов в строках с помощью команд `WHERE … LIKE`
- любое количество символов: `%`
- один единственный символ: `_`

`F5A123` соответствует шаблону `'F5_1%'`.

`'%SAVE%'` соответствует шаблонам `'SAVEMORE'` и `'HOLIDAYSAVE30'`

Вы можете включать несколько запросов в свой SQL-код. Просто разделите их **точкой с запятой** (`;`):
```sql
SELECT name, code
FROM products;

SELECT name
FROM products
WHERE code LIKE 'A_B_';
```
> CREATE TABLE
> 
> INSERT 0 3
> 
> |name	|code|
> |-----|----|
> |pen	|A154B|
> |eraser |A8B5|
> |notepad |A4B8|
> (3 rows)
> |name|
> |eraser|
> |notepad|
> (2 rows)

Шаблоны чувствительны к регистру.

Команды `LOWER()` и `UPPER()` используются для преобразования строк в нижний или верхний регистр.
```sql
/*
Преобразует строки в поле 
названия в нижний регистр
*/
SELECT LOWER(title)
FROM movies;

/*
Преобразует строки в поле 
названия в верхний регистр
*/
SELECT UPPER(title)
FROM movies;
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |lower
> |-----
> |home alone
> |star wars
> |jurassic park
> |frozen
> |pirates of the caribbean
> |(5 rows)
> |upper
> |HOME ALONE
> |STAR WARS
> |JURASSIC PARK
> |FROZEN
> |PIRATES OF THE CARIBBEAN
> |(5 rows)

Запрос для извлечения всех имен сотрудников в нижнем регистре:
```sql
SELECT LOWER(name)
FROM employeers
```

Используйте `LOWER` (или `UPPER`) с `LIKE` в команде `WHERE` для поиска **шаблонов без учета регистра**.
```sql
SELECT title
FROM books
WHERE LOWER(title) LIKE '%cooking%'
```

Запрос выполняет поиск шаблона без учета регистра и создает таблицу результатов с названиями книг неизменными.

Вы можете использовать как операцию `UPPER()`, так и `LOWER()` для **поиска шаблонов без учета регистра**. Символы в вашем шаблоне должны соответствовать вашей операции.
```sql
ELECT name
FROM employees
WHERE UPPER(name) LIKE 'DAN%'
```

Следующий запрос для выполнения поиска шаблона без учета регистра:
```sql
SELECT title
FROM books
WHERE LOWER(title) LIKE "%robots%"
```

### [Назад к оглавлению](#back)


<a id="condition_sql"></a>
Условия в SQL
---

- вы можете использовать различные **операторы сравнения** для определения условий
- условия необходимы для фильтрации данных

Вы можете использовать условия для написания более точных запросов и извлечения только нужных данных. В этом уроке вы узнаете, как это сделать.

Следующий запрос извлечет записи песен, которые были выпущены после 2020 года:
```sql
SELECT *
FROM songs
WHERE year > 2020
```

Этот запрос извлечет песни, выпущенные в 2020 году:
```sql
SELECT *
FROM songs
WHERE year = 2020
```

Операция сравнения всегда дает либо Правда, либо Ложь.
- `15 > 20`: **false**
- `7 < 13`: **true**

Вы уже знакомы с операторами сравнения `>`, `<` и `=`. 

Существуют и другие операторы сравнения, которые можно использовать для более точных запросов:

- **больше или равно** - `>=`
- **меньше или равно** - `<=`
- **не равно** - `<>`

Например:
- **7 = 7:** `true`
- **7 <> 7:** `false`
- **8 <= 6:** `false`
- **9 >= 9:** `true`

В таблице ниже, фильмы **Pirates of the Caribbean** и **Frozen** соответствуют условию year >= 2003; так-же все фильмы, кроме **Frozen** - соответствуют условию year <> 2013.

![movies](https://lecontent.sololearn.com/material-images/37858e877d92409990f8c79cdd5b5b73-3.03.08.png)

Следуюий запрос извлечет **Star Wars**:
```sql
SELECT title
FROM movies
WHERE title = 'Star Wars'
```

Следующий запрос ничего не извлечет, т.к. есть ошибка (пропущены кавычки в вокруг строки **Home Alone**):
```sql
SELECT title
FROM movies
WHERE title = Home Alone
```

Следующий запрос извлечет **1990**
```sql
SELECT year
FROM movies
WHERE title = 'Home Alone'
```

При выполнении фильтрующего запроса будут извлечены только те записи, для которых условие истинно. 

Ниже приведен код, который даст 2 таблицы. Первая помогает нам увидеть, какие записи соответствуют условию. Вторая - результат фильтрующего запроса.
```sql
/*
Показывает, соответствуют ли записи
условию или нет
pravda (true) или ложь (false)
*/
SELECT year, year > 2000 AS result
FROM movies;

/*
Фильтрующий запрос, который извлекает
только записи, для которых условие истинно (True)
*/
SELECT title
FROM movies
WHERE year > 2000
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |year	|result |
> |----|--------|
> |1990	|f |
> |1977	|f |
> |1993	|f |
> |2013	|t |
> |2003	|t |
> (5 rows)
> 
> |title|
> |----|
> |Frozen|
> |Pirates of the Caribbean|
> (2 rows)


Запрос, извлекающий только товары, имеющиеся в наличии:
```sql
SELECT name
FROM products
WHERE quantity <> 0;
```

**Оператор неравенства** `<>` может использоваться как с числовыми значениями, так и со строковыми значениями.

![songs](https://lecontent.sololearn.com/material-images/eeab51d4f009455badd26cc041db4c52-3.03.17.png)

```sql
/*Точка с запятой не требуется для отдельных запросов,
но рекомендуется использовать точку с запятой для ясности,
согласованности и читаемости*/
SELECT *
FROM songs
WHERE category <> 'Jazz';
```
> CREATE TABLE
> 
> INSERT 0 4
> 
> |id	|name	|category |
> |-----|-------|---------|
> |1	|Shape of You	|Pop |
> |2	|Stairway to Heaven |Rock |
> |4	|Symphony No. 5	|Classic |
> (3 rows)

Следующий запрос извлекает записи песен, которые не относятся к категории **Jazz**:
```sql
SELECT *
FROM songs
WHERE category <> 'Jazz';
```

Извлечение песен, которые не превышают три минуты:
```sql
SELECT titles
FROM songs
WHERE length < 3
```


### [Назад к оглавлению](#back)


<a id="practis_car_select"></a>
Выбери свою машину (практика)
---

ПРАКТИЧЕСКОЕ УПРАЖНЕНИЕ

Компания по аренде автомобилей хочет показать клиентам доступные машины в рамках их бюджета. Дана следующая таблица `cars`:

![cars](https://lecontent.sololearn.com/material-images/591e3064aa3444e48644009e897ae783-d828b1794b4246418b627be00d7e7cb7-draftcc13.png)

Напишите запрос для выбора `make` машины, `model` и `price_per_day` из таблицы машин, где цена за день меньше или равна $100.
```sql
/*
table name: cars
выбрать make машины, model и price per day
где цена за день меньше или равна $100
*/

SELECT make, model, price_per_day
FROM cars
WHERE price_per_day <= 100
```

### [Назад к оглавлению](#back)


<a id="date_agregate"></a>
Агрегация данных
---

- **операции агрегации** суммируют данные, чтобы получить 1 единственное числовое значение
- **MAX(), MIN(), COUNT(), SUM() и AVG()** - это примеры операций агрегации

Мы часто принимаем лучшие решения, используя данные из разных источников. В этом уроке вы узнаете, как суммировать данные с помощью **операций агрегации**.

![movies](https://lecontent.sololearn.com/material-images/2d4f94c59b474dce9d9e6a096097cf37-3.04.02.png)

**MAX()** - это пример операции агрегации. Максимальным значением для поля `year` - `MAX(year)` - будет 1993.

**MIN()** - еще один пример операции агрегации. **Результатом** операции агрегации является **одно числовое значение**. Соответственно `MIN(year)` будет равняться 1977.

**Агрегация** - 
- работает с **несколькими значениями**,
- для получения **одного единственного значения**.

Вы можете использовать операции агрегации в своих запросах.
```sql
/*
Извлекает наивысшее
значение в поле year
*/
SELECT MAX(year)
FROM movies;

/*
Извлекает наименьшее
значение в поле year
*/
SELECT MIN(year)
FROM movies;
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |max|
> |---|
> |2013|
> (1 row)
> |min|
> |1977|
> (1 row)

Запрос, чтобы извлечь самый старый фильм:
```sql
SELECT MIN(year)
FROM movies;
```

Помните, что вы можете создавать таблицы результатов с более чем одной колонкой. Просто разделите колонки запятыми:
```sql
SELECT MIN(year), MAX(year)
FROM movies;
```

**COUNT()** - это еще одна операция агрегации. Она подсчитывает количество записей. Результатом следующего запроса будет, несомненно - три.
```sql
SELECT COUNT(year)
FROM movies;
```

**SUM()** - это еще одна операция агрегации. Она вычисляет общую сумму значений в числовом поле.

![products](https://lecontent.sololearn.com/material-images/269f48070ab04b11b7fc3e7230ce213d-3.04.14.png)

Результатом следующего запроса - будет 18:

```sql
SELECT SUM(price)
FROM products;
```

**AVG()** - это еще один пример операции агрегации. Она вычисляет среднее значение.
```sql
SELECT AVG(price)
FROM products;
```

### [Назад к оглавлению](#back)


<a id="data_mix"></a>
Смешиваем все вместе
---

- **агрегационные** и **фильтрационные** операции могут быть объединены в запросах
- операции фильтрации выполняются **перед** агрегацией
- агрегационные операции также называются **функциями**

Комбинация **агрегации** и **фильтрации** часто используется при анализе данных. В этом уроке вы узнаете, как выполнять SQL-запросы, которые суммируют данные, удовлетворяющие условию.

Следующий запрос приводит к одному числовому значению:
```sql
SELECT AVG(price)
FROM products;
```

![movies](https://lecontent.sololearn.com/material-images/a4c9559a0cf64e1395f5861a9e28a4e1-2.05.05.png)

Следующий запрос извлечет три записи о фильмах:
```sql
SELECT *
FROM movies
WHERE year > 2000
```

Запрос для вычисления самой высокой цены:
```sql
SELECT MAX(price)
FROM products;
```

Вы можете выбирать выполнение агрегационных операций только для записей, удовлетворяющих определенному условию.

![movies](https://lecontent.sololearn.com/material-images/879d3a03f804424788be35588595a34e-2.03.13.png)
```sql
SELECT MIN(year)
FROM movies
WHERE year > 2000
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |min
> |---
> |2003
> (1 row)

Вы можете создать запрос, который объединяет фильтрацию с агрегационной операцией:
```sql
SELECT MIN(year)
FROM movies
WHERE year > 2000;
```

Или создать запрос, который подсчитывает количество записей после фильтрации:
```sql
SELECT COUNT(price)
FROM products
WHERE price > 10
```

При выполнении запросов, включающих различные операции, сначала происходит фильтрация. Результатом следующего запроса будет 2003:
```sql
SELECT MIN(year)
FROM movies
WHERE year > 2000
```

Если запрос содержит операции агрегации и фильтрации, операция фильтрации происходит **первой**.

Pапрос для вычисления суммы цен для продаж, где статус `'completed'`:
```sql
SELECT SUM(price)
FROM sales
WHERE status='completed'
```

Помните, что вы можете создавать таблицы результатов с несколькими столбцами, разделяя операции агрегации запятыми:

![sales](https://lecontent.sololearn.com/material-images/db8d4b1caa8b4177ab4c395257484dde-3.05.11.png)
```sql
/* Результат AVG всегда является десятичным числом */
SELECT SUM(price), AVG(price)
FROM sales;
```
> CREATE TABLE
> 
> INSERT 0 3
> 
> |sum	avg
> |---
> |18	6.0000000000000000
> (1 row)

Следующим запросом будет вычислено два числовых значения:
```sql
SELECT MAX(year), MIN(year)
FROM movies
WHERE studio_id = 3
```

Следующий запрос вычислит два числовых значения - 2013 и 2003:

![movies](https://lecontent.sololearn.com/material-images/758258412ac24cf793d15c8961dc1509-3.05.13.png)
```sql
SELECT MAX(year), MIN(year)
FROM movies
WHERE studio_id = 3
```

Вы можете комбинировать агрегацию с другими математическими операциями.
![sales](https://lecontent.sololearn.com/material-images/e18a3de097264f8b9d8952599660f65a-3.05.11.png)
```sql
SELECT SUM(price+delivery) AS revenue
FROM sales;
```
> CREATE TABLE
> 
> INSERT 0 3
> 
> |revenue
> |-----
> |26
> (1 row)

Результатом следующего запроса будет 21:
```sql
SELECT SUM(price+delivery) AS revenue
FROM sales
WHERE status = 'completed'
```

Агрегационные операции обычно называются **агрегатными функциями**. Функция включает код, необходимый для выполнения задачи.

Пример запроса, использующего агрегатную функцию:
```sql
SELECT AVG(price)
FROM sales;
```

**MAX(), MIN(), COUNT(), SUM() и AVG()**- примеры агрегатных функций.

### [Назад к оглавлению](#back)


<a id="exam_3"></a>
Контрольные вопросы к модулю 3
---

```sql
1.
Сопоставьте операции сравнения с их результатами

5=5:True
5<>5:False
```
---
2.
![produts](https://lecontent.sololearn.com/material-images/7c8a39fda276433b8521222ed5ca2c88-3.modulequiz.png)
```sql
SELECT *
FROM products
WHERE price <= 40;
```
Какой продукт НЕ будет извлечен

- [x] Skirt
- [ ] Hoodie
---

```sql
3.
Что извлечет этот код?

SELECT *
FROM employee
WHERE salary > 5000;

[] сотрудники, зарплата которых не равна 5000
[x] сотрудники, зарплата которых больше 5000
[] сотрудники, зарплата которых равна 5000
```
```sql
4.
Извлеките записи о доставке, где город не является 'London':

SELECT *
FROM delivery
WHERE city <> 'London';
```
```sql
5.
Что извлекает запрос?

SELECT title, author
FROM articles
WHERE title 
LIKE '%Artificial Intelligence%'

[] Статьи, написанные «Artificial Intelligence»
[x] Статьи с «Artificial Intelligence» в названии
```
```sql
6.
Каков результат этого кода?

SELECT LOWER(category)
FROM products;

[] Инициалы для значений категории в нижнем регистре
[] Значения категории в верхнем регистре
[x] Значения категории в нижнем регистре
```
---
7.
![promo_codes](https://lecontent.sololearn.com/material-images/700fff2096db4e0d80e23dd2fb1ce6ef-3.modulequizlp7.png)
```sql
Какой шаблон соответствует 3 промо-кодам?

[x] LOWER(code) LIKE '%save%'
[] UPPER(code) LIKE '%save%'
```
---
```sql
8.
Какие записи о книгах соответствуют шаблону 'The%King_'

Выберите все правильные ответы:

[] The Patient King3B
[x] The Warrior King2
[x] The Warrior King1
[] The Silent King
```
```sql
9.
Завершите запрос для извлечения всех сотрудников в отделе маркетинга

SELECT *
FROM employees
WHEREdepartment = 'Marketing'
```
```sql
10.
Введите подстановочный символ, который используется с LIKE рядом с объяснением

Представляет любой одиночный символ: `_` 
Представляет любое количество символов: `%` 
```
```sql
11.
Рассчитайте средний возраст сотрудников, работающих в компании более 5 лет:

SELECT AVG(age)
FROM employees
WHERE experience > 5;
```
```sql
12.
Найдите самую высокую зарплату в отделе 'Engineering'

SELECT MAX(salary)
FROM employees
WHERE department = 'Engineering'
```
```sql
13.
Как разделить несколько запросов в одном SQL-коде?

[x] с точкой с запятой
[] с запятыми
[] с круглыми скобками
```

### [Назад к оглавлению](#back)


<a id="data_analise_h1"></a>
Анализ данных
===

<a id="data_analise_h2"></a>
Анализ данных
---


- Сырые данные требуют анализа
- Первый шаг в анализе данных - определение вашего вопроса
- Данные могут поступать из разных источников, и вы можете использовать разные методы для сбора данных

![steps](https://lecontent.sololearn.com/material-images/0eb6c804edde44a8a2443ac6277edd26-SQL4.01.01.png)

Сырые (или необработанные) данные должны быть обработаны и проанализированы, чтобы их можно было использовать для принятия решений. Этот процесс включает различные шаги. 

В этом уроке вы узнаете о первых шагах в процессе **анализа данных**, начиная с **вопросов**.

![movies](https://lecontent.sololearn.com/material-images/84bec07c795e46c7823e1c8dc07cea50-3.03.08.png)

Выберите вопрос, на который можно ответить с помощью информации, хранящейся в наборе данных о movies.
- Какой самый старый фильм?
- Какие из фильмов являются частью трилогии?
- Какой фильм имеет самый высокий рейтинг?

В таблице есть данные о названии фильмов, и года выпуска, следовательно правильным ответом бдует вопрос об возрасте фильмов.

Query (запрос) - термин для запроса информации из базы данных.

Следующий запрос отвечает на вопрос об количестве фильмов в базе данных:
```sql
SELECT COUNT(title)
FROM movies
```

Схема базы данных помогает нам проверить, можно ли ответить на вопрос с помощью данных.

![scheme](https://lecontent.sololearn.com/material-images/3215cccd214243ee9ddb57762b4bbe06-1.04.11(2).png)

Схема визуализирует, как организована база данных. Например с помощью информации в схеме выше, можно ответить на вопрос: - Какой самый большой отдел? 

В схему включены:
- Имена полей
- Ключи
- Имена таблиц

Количество записей меняется при добавлении новых данных в базу данных. 

Схема НЕ показывает количество записей в таблицах именно потому что это количество может измениться.

Это изображение показывает схему базы данных о фильмах:

![scheme](https://lecontent.sololearn.com/material-images/004240e440cc401fbe1ba2339cf567c8-1.04.05.png)

- таблиц в базе данных - две,
- полей в таблице студий - три.

На некоторые вопросы можно ответить с помощью фильтрующего запроса. Например запрос, чтобы определить студентов, у которых оценка - 100:
```sql
SELECT name
FROM students
WHERE grade=100;
```

Или определить пользователей, которые достигли или превысили уровень 10:
```sql
SELECT username
FROM users
WHERE level>=10;
```

Следующий запрос отвечает на вопрос о среднем балле в классе:
```sql
SELECT AVG(grade)
FROM class
```
---
![steps](https://lecontent.sololearn.com/material-images/c3a2af7102e44937836be54b9c02af3e-Frame27153(1).png)

После того, как ваш вопрос был определен, следующим шагом обычно является сбор данных для ответа на него.

Данные непрерывно генерируются и могут поступать из разных источников, например:
- даты твитов - социальные данные
- пульс - данные устройства
- суммы платежей - транзакционные данные

![interaction](https://lecontent.sololearn.com/material-images/d38a41d87d4c4075b3c3b394e03b04b7-4.01.16.png)

Много данных находится в Интернете. Серверы - это компьютеры, которые всегда слушают запросы на получение информации. Вы можете запрашивать информацию из базы данных сервера через API (интерфейс прикладного программирования). 

Существуют API для запроса данных из Facebook, Youtube, Wikipedia и практически любой другой платформы.

Представьте, что вы работаете над проектом, который требует точных данных о музыкальных исполнителях, альбомах и треках.

Как бы вы собрали данные?

- Связь с исполнителями?
- API Spotify?
- Данные опроса?

Очевидно, что самым практичным и точным вариантом является API Spotify.

В Интернете есть огромный объем информации. **Веб-скрапинг** позволяет извлекать информацию с веб-сайтов. 

Некоторые знания HTML и языка программирования, такого как **Python**, помогут вам извлечь нужную информацию из Интернета.

Для сбора данных вы можете использовать:
- запрос данных из **базы данных**
- подключение к серверам с помощью **API**
- **скрапинг** веб-страниц

### [Назад к оглавлению](#back)


<a id="grouping"></a>
Группировка
---

- **GROUP BY** организует данные по категориям
- **GROUP BY** часто используется в сочетании с агрегацией

**Группировка данных** - это мощный инструмент при работе с большими наборами данных. Группировка позволяет собирать и просматривать данные по-новому, чтобы ответить на более сложные вопросы. 

На этом уроке вы узнаете, как группировать информацию, чтобы видеть закономерности и взаимосвязи. 

Группировка часто используется в сочетании с агрегацией. Давайте разомнемся! Следующий запрос агрегации приведет к одному числовому значению:
```sql
SELECT MAX(price)
FROM products
```

Следующий запрос извлечет средний `rating` для `products`:
```sql
SELECT AVG(rating)
FROM products
```

**GROUP BY** позволяет организовать похожие данные в категории. Он используется в сочетании с агрегацией для вычисления ключевых показателей для группы записей.

![movies](https://lecontent.sololearn.com/material-images/a98e40130a884fe081ec92aaadebb00a-sql4.02.04.png)
```sql
/* Группирует записи по жанру и 
вычисляет средний бюджет для каждой группы */
SELECT genre, AVG(budget)
FROM movies
GROUP BY genre;
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |genre	|avg|
> |-----|-----|
> |drama	|127.5000000000000000|
> |fantasy	|124.0000000000000000|
> |comedy	|18.0000000000000000|
> (3 rows)

Группировка данных позволяет нам отвечать на вопросы. 

Например вот SQL-запрос для вычисления суммы бюджетов для разных жанров фильмов:
```sql
SELECT genre, SUM(budget)
FROM movies
GROUP BY genre
```

Для группировки данных требуется хотя бы одно поле. Данные в этой таблице результатов сгруппированы по жанру.

Или вот, запрос для вычисления общего количества каждого продукта:

![scheme](https://lecontent.sololearn.com/material-images/5b119f2abc9b4bfab038c002ccaab73b-SQL4.02.07.png)
```sql
SELECT product_id, SUM(quantity)
FROM orders
GROUP BY product_id;
```

Следующий запрос для подсчета продуктов в каждой группе категорий:
```sql
SELECT category, COUNT(product)
FROM products
GROUP BY category;
```

Запрос для вычисления средней зарплаты по отделам:
```sql
SELECT department, AVG(salary)
FROM employees
GROUP BY department;
```

Запрос для вычисления наименьшего бюджета фильма для каждого жанра:
```sql
SELECT genre, MIN(budget)
FROM movies
GROUP BY genre;
```

На основе следующей таблицы фильмов,

![movies](https://lecontent.sololearn.com/material-images/abe1c385bda845afa0d36e333ec39416-Frame27201.png)

Нижележащим запросом, будет вычеслено три средних значения:

```sql
SELECT genre, AVG(budget)
FROM movies
GROUP BY genre;
```

Следующий запрос сгенерирует таблицу результатов с двумя категориями и двумя числовыми значениями:

![query](https://lecontent.sololearn.com/material-images/8b559cba45ed4fb98a73d302007ce80d-SQL4.02.12.png)
---

Если запрос группировки данных не сформулирован правильно, это может привести к ошибкам или к данным, которые не имеют смысла.
```sql
SELECT title, AVG(budget)
FROM movies
GROUP BY genre;
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> ERROR:  column "movies.title" must appear in the GROUP BY clause or be used in an aggregate function
>         SELECT title, AVG(budget)

Исправим код:
```sql
SELECT title, AVG(budget)
FROM movies
GROUP BY title;
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |title	|avg|
> |-----|-----|
> |Titanic	|200.0000000000000000|
> |Avatar	|237.0000000000000000|
> |Forrest Gump	|55.`0000000000000000|
> |Home Alone	|18.0000000000000000|
> |Star Wars	|11.0000000000000000|
> (5 rows)

Помните, что вы можете использовать ключевое слово **AS**, чтобы дать имя полям в таблице результатов:
```sql
SELECT genre, AVG(budget) AS avg_budget
FROM movies
GROUP BY genre;
```

**GROUP BY** помещает данные с одинаковыми значениями в одну категорию. Данные в одной группе имеют одно и то же значение для **поля (столбца)**.

**GROUP BY** чаще всего используется в сочетании с **агрегацией**.

Ещепример запроса для вычисления количества для каждой категории:
```sql
SELECT category, SUM(quantity)
FROM sales
GROUP BY category;
```

### [Назад к оглавлению](#back)


<a id="posting"></a>
Посты в социальных сетях (практика)
---

ПРАКТИЧЕСКОЕ УПРАЖНЕНИЕ

Социальная платформа хочет проанализировать вовлеченность и предпочтения пользователей, группируя и подсчитывая реакции на посты (“likes”). Дана следующая таблица posts:

![posts](https://lecontent.sololearn.com/material-images/ce0244823b7247839f57d42263dd2d64-190a8cc04f4e4e078f999a649e8bcc6f-grouping2.png)

Напишите запрос для извлечения суммы likes для каждой темы:
```sql
/*
таблицa: posts
извлечь сумму likes для каждой темы
*/
SELECT topic, SUM(likes)
FROM posts
GROUP BY topic
```

### [Назад к оглавлению](#back)


<a id="grouping_filtering"></a>
Группировка и фильтрация
---

- Вы можете объединить **WHERE** с **GROUP BY**, чтобы сначала отфильтровать данные, а затем сгруппировать их
- Вы можете использовать **HAVING** для сначала группировки данных, а затем фильтрации

В этом уроке вы узнаете, как объединить группировку и фильтрацию в одном запросе! Это позволит вам принимать более обоснованные решения на основе ваших данных.

Пример запроса для вычисления средней цены по категориям:
```sql
SELECT category, AVG(price)
FROM products
GROUP BY category;
```

Пример ззапроса для извлечения имен и зарплат сотрудников в отделе "IT:
```sql
SELECT name, salary
FROM employees
WHERE department = 'IT';
```

Вы можете объединить **GROUP BY** с фильтрами **WHERE**. Данные фильтруются сначала, а затем группируются.

![pic](https://lecontent.sololearn.com/material-images/c142abf6ac07419fa752acf9e1d3fbaf-SQL4.03.04.png)
```sql
SELECT genre, AVG(budget)
FROM movies
WHERE budget > 50
GROUP BY genre;
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |genre|	avg|
> |---|---|
> |fantasy|	237.000000000000|
> |drama|	127.5000000000000000|
> (2 rows)

Запрос для фильтрации, группировки и агрегации данных:
```sql
SELECT category, AVG(price)
FROM products
WHERE rating >= 4
GROUP BY category;
```

Запрос для извлечения максимальной **price** для каждого типа **product**, проданного в **New York**:
```sql
SELECT product, MAX(price)
FROM sales
WHERE city='New York'
GROUP BY product;
```

Запрос для подсчета количества сотрудников в каждом отделе с зарплатой выше 5000:
```sql
SELECT department, COUNT(*)
FROM employees
WHERE salary > 5000
GROUP BY department;
```

Когда запрос содержит и **WHERE**, и **GROUP BY** - данные фильтруются сначала, а затем группируются.

**HAVING** позволяет фильтровать данные, которые были сгруппированы.
![having](https://lecontent.sololearn.com/material-images/7e96ad98171e4490a190763dd89d279f-SQL4.03.09.png)
```sql
SELECT genre, AVG(budget)
FROM movies
GROUP BY genre
HAVING AVG(budget) > 50;
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |genre|	avg|
> |----|----|
> |drama|	127.5000000000000|
> |fantasy|	124.0000000000000000|
> (2 rows)

Код для группировки сначала, а затем фильтрации:
```sql
SELECT class, AVG(score)
FROM students
GROUP BY class
HAVING AVG(score) > 85;
```

Запрос для определения авторов, которые опубликовали более трех книг:
```sql

SELECT author, COUNT(*)
FROM books
GROUP BY author
HAVING COUNT(*) > 3;
```
---
![query](https://lecontent.sololearn.com/material-images/2dcc13c8e0424cb992ab70945b6c99c4-SQL4.03.12.png)

Запрос на картинке выше - приведет к таблице с тремя строками.

![query2](https://lecontent.sololearn.com/material-images/1cd2c1db411c4156863a8b8a54039564-SQL4.03.13.png)

Этот запрос приведет к таблице с двумя строками. Значения, которые будут извлечены с помощью этого запроса - 7500 и 7000.

Когда запрос содержит и **GROUP BY**, и **HAVING** - данные группируются сначала, а затем фильтруются.

Запрос для вычисления средней зарплаты по отделам:
```sql
SELECT department, AVG(salary)
FROM employees
GROUP BY department;
```

Запрос исключает сотрудников с зарплатой ниже 5000, затем вычисляет среднюю зарплату по отделам:
```sql
SELECT department, AVG(salary)
FROM employees
WHERE salary >= 5000
GROUP BY department;
```

Запрос вычисляет среднюю зарплату по отделам сначала, а затем показывает отделы с средней зарплатой больше 5000:
```sql
SELECT department, AVG(salary)
FROM employees
GROUP BY department
HAVING AVG(salary) > 5000;
```

Запрос для поиска месяца в 2022 году с наибольшим доходом:
```sql
SELECT month, MAX(revenue)
FROM revenues
WHERE year = 2022
GROUP BY month;
```

### [Назад к оглавлению](#back)


<a id="data_clean"></a>
Очистка данных
---

- Проблемы с качеством данных могут повлиять на точность анализа данных
- Вы можете использовать **DISTINCT** для устранения дублирования данных
- **NULL** означает отсутствие значений данных

![clean](https://lecontent.sololearn.com/material-images/f731e4e2686242f09e05687eaaca83bc-Frame27154(1).png)

Сырые данные могут содержать проблемы с качеством. 

**Очистка данных** является ключевым этапом процесса анализа данных. В этом уроке вы узнаете, как исправлять ошибки в собранных данных.

Например на следующем изображении - можно увидеть что данные могут дублироваться:

![employees](https://lecontent.sololearn.com/material-images/fc7f86438d104696bef2dd47b45ac432-4.04.02.png)

**Дублированные данные** - это очень распространенная проблема. Это означает наличие дополнительных копий одних и тех же данных.

Включение дублированных данных в расчеты и анализ может привести к некорректным данным для анализа.

![employees_query](https://lecontent.sololearn.com/material-images/90ca0f4275644d8a89ee72f9b336d7b4-Frame27175(1).png)

Дублирование данных приведет к тому, что SQL-запрос на изображении выше - вычислит неверное количество сотрудников.

Вы можете использовать **GROUP BY** в сочетании с **HAVING** для проверки дубликатов в данных:
```sql
-- проверка дубликатов id
SELECT id, COUNT(id)
FROM employees
GROUP BY id
HAVING COUNT(id) > 1;
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |id|	count|
> |---|---|
> |4|	2|
> (1 row)

Запрос для проверки дублированных title:
![movies](https://lecontent.sololearn.com/material-images/d5d2f82b38094220b5dd5ded23a38d3b-Frame27179(4).png)
```sql
SELECT title, COUNT(title)
FROM movies
GROUP BY title
HAVING COUNT(title) > 1;
```

Вы можете объединить группировку по нескольким полям, чтобы проверить дублирование данных по нескольким полям одновременно.

![emoloyees](https://lecontent.sololearn.com/material-images/147b726eb2e24ec9af45eb1f0339b71e-4.04.02.png)
```sql
/* проверка сочетания
дубликатов id и имени */
SELECT id, name
FROM employees
GROUP BY id, name
HAVING COUNT(id) > 1;
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |id	|name|
> |---|---|
> |4	|Alice Williams|
> (1 row)

Запрос для проверки дублированных значений в полях **id** и **title**:
```sql
SELECT id, title
FROM movies
GROUP BY id, title
HAVING COUNT(id) > 1
```

Вы можете группировать данные по нескольким полям, разделяя их запятой. Вы можете использовать это для проверки дублирования данных по нескольким полям одновременно.
```sql
SELECT *
FROM employees
GROUP BY id, name, department, age
HAVING Count(name) > 1;
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |id	|name	|department	|age|
> |----|----|----|---|
> |4	|Alice Williams	|Management	|19|
> (1 row)

Дублированные данные могут значительно влиять на качество и точность анализа. Используйте **DISTINCT** для извлечения уникальных значений и устранения дубликатов.

![emlpoyees](https://lecontent.sololearn.com/material-images/a50d6ec3b146419da62a73f85a7a66f2-4.04.02.png)
```sql
/* DISTINCT используется перед
полем, которое мы хотим извлечь */
SELECT DISTINCT name
FROM employees;
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |name
> |----
> |Alice Williams
> |John Doe
> |Bob Johnson
> |Jane Smith
> (4 rows)

Запрос для извлечения уникальных `movie genres`:
```sql
SELECT DISTINCT genre
FROM movies
```

Следующий запрос на изображени - создаст таблицу результатов с тремя строками:

![users](https://lecontent.sololearn.com/material-images/5250c529289142b09e91715f43252e48-4.04.12.png)

Вы можете объединить **DISTINCT** с фильтрацией:
```sql
SELECT DISTINCT genre
FROM movies
WHERE year > 1990;
```

Проблемы с качеством данных могут быть результатом ошибок при сборе данных и вводе данных.

![cutomers](https://lecontent.sololearn.com/material-images/5896071cc1344be9ae4135ecb806f41a-Frame27090(4).png)

Еще одна распространенная проблема с качеством данных, которую мы можем увидеть на изображении, это отсутствующие данные.

**NULL** используется для указания, что **значение данных отсутствует** и его нет в базе данных. Значения NULL не отображаются в результатах таблиц.

![movies](https://lecontent.sololearn.com/material-images/477447c15303421ea2af63527c8d28cc-Frame7161(2).png)
```sql
SELECT *
FROM movies
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |id	|title	|budget	|genre
> |---|----|----|---|
> |1	|Home Alone	|18|	 
> |2	|Star Wars	|11	|fantasy|
> |3	|Titanic	|200|	 
> |4	|Avatar	        |237	|fantasy|
> |5	|Forrest Gump	|55|	 
> (5 rows)

**NULL** означает, что значение данных не существует.

Вы можете проверить, содержит ли ваше поле отсутствующие значения. Используйте **IS NULL** в сочетании с **WHERE** для поиска отсутствующих значений.

![movies](https://lecontent.sololearn.com/material-images/ebe4a34a0d30461db2aba7f54d29612e-Frame7161(2).png)
```sql
SELECT * 
FROM movies 
WHERE genre IS NULL
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |id	|title	|budget	|genre
> |----|----|----|---|
> |1	|Home Alone	|18	 
> |3	|Titanic	|200	 
> |5	|Forrest Gump	|55	 
> (3 rows)

Запрос для выявления пользователей с отсутствующими данными о прогрессе
```sql
SELECT name
FROM users
WHERE progress IS NULL;
```

Аналогично вы можете извлекать значения, **не являющиеся NULL**, используя **IS NOT NULL**. Это позволяет фильтровать нулевые значения.

![movies](https://lecontent.sololearn.com/material-images/a616713a08bc464cb56aa07fa1151557-Frame7161(2).png)
```sql
SELECT * 
FROM movies 
WHERE genre IS NOT NULL
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |id	|title	|budget	|genre|
> |---|------|---|---|
> |2	|Star Wars	|11	|fantasy
> |4	|Avatar	        |237	|fantasy
> (2 rows)

Фильтрация отсутствующих данных - это один из способов работы с неполными данными. Разные подходы используются в зависимости от того, откуда идут данные или какой анализ необходимо выполнить.

### [Назад к оглавлению](#back)


<a id="data_about_teachers"></a>
Данные о преподавателях (практика)
---

ПРАКТИЧЕСКОЕ УПРАЖНЕНИЕ

Школа хочет получить список предметов, преподаваемых ее учителями. Дана следующая таблица `teachers`:

![teachers](https://lecontent.sololearn.com/material-images/5fc946d62ae1469280a387e8826b7da7-57efcd4392d84f7cbfb5a3cac222af35-cleaning2.png)

Напишите запрос для извлечения уникальных предметов `subjects`, которые преподавались.
```sql
/*
таблицa: teachers
выбрать уникальные subjects в школе
*/
SELECT DISTINCT subject
FROM teachers
```

### [Назад к оглавлению](#back)


<a id="data_type_correction"></a>
Исправление типов данных
---

Данные имеют разные формы и виды. Данные в неправильном формате могут вызвать проблемы.

На этом уроке вы узнаете, как обнаруживать и исправлять ошибки в типах данных.

![tasks](https://lecontent.sololearn.com/material-images/394d68c1ecf741c4949d078f132a36c1-Fraf(3).png)

Поля в этой таблице содержат разные типы данных:
- description - строка,
- priority - числовой тип данных.

![patients](https://lecontent.sololearn.com/material-images/c0a164322f74417586205946f402bd0c-4.05.03.png)
- name: строка
- age: числовой
- appointment: дата/время

Определение проблемы качества данных в следующей таблице:

![patients](https://lecontent.sololearn.com/material-images/e39f69b73ed7442fab67d511d2f785e1-4.05.04.png)

- дублирование: 3
- пропущенное значение: 2
- неверный тип данных: 1

Некоторые типы данных явно указаны в SQL-коде.
```sql
SELECT *
FROM movies
WHERE title = 'Home Alone';
```

Как можно узнать, что значение является строкой? - Строковые значения окружены кавычками.

Неправильное использование типов данных может привести к ошибкам. Следующий код - вызовет ошибку:
```sql
SELECT *
FROM movies
WHERE title = Home Alone;
```

Вы собираетесь познакомиться с новым типом данных. Для начала вспомним, что результатом операции сравнения `150 > 250` будет - `False`. 

Электронные схемы внутри компьютеров используют миллионы маленьких переключателей для хранения значений **Правда/Ложь**. У переключателей есть всего две позиции - **Вкл/Выкл**. 

Компьютеры используют двоичный код для представления информации. Включая и выключая переключатели, мы изменяем хранящуюся в компьютере информацию.

В этом контексте, **двоичный** - означает два варианта состояния переключателя.

Тип данных, который хранит одно из двух возможных значений (Правда или Ложь), называется **булевым**.

![users](https://lecontent.sololearn.com/material-images/19bf1eaf73e24e6e9139334be919c47f-4.05.11.png)

В таблице выше, поле `is_verified` - хранит **булевы** значения.

![movies](https://lecontent.sololearn.com/material-images/23e02a960f02438c87c7e73166c48538-4.05.12.png)

В этой таблице - булевы значения в поле `is_oscar_winner`, соответсвтенно оскар получили Star Wars, Titanic и Forrest Gump.

Вы можете использовать булевы значения при фильтрации данных. Если поменять в следующем запросе `True` на `False`, можно узнать фильмы НЕ получившие оскар:
```sql
SELECT  id, title, is_oscar_winner
FROM movies
WHERE is_oscar_winner = False;
```

Результат операции сравнения всегда является булевым значением.

![movies](https://lecontent.sololearn.com/material-images/5355a0fce2924fc6a8ce2c9c690d6665-4.05.16.png)
```sql
SELECT title
FROM movies
WHERE budget > 50;
```
> CREATE TABLE
> 
> INSERT 0 5
> 
> |title
> |---
> |Titanic
> |Avatar
> |Forrest Gump
> (3 rows)

- Значения данных могут классифицироваться по разным **типам данных**
- Тип **булевых** данных имеет два возможных значения: **True** (правда) или **False** (ложь)

### [Назад к оглавлению](#back)


<a id="data_understand"></a>
Понимание данных
---

- **Булевы** значения помогают вам писать более сложные и эффективные запросы
- **Логическая операция** принимает несколько булевых значений и производит одно логическое значение
- **AND (Логическое И)** принимает значение **True** только тогда, когда все значения одновременно **True**
- **OR** дает результат **True**, если хотя бы одно из условий **True**

![insights](https://lecontent.sololearn.com/material-images/2180640e4df149b495893258f714175c-Frame7155(1).png)

Извлечение информации из очищенных данных заключается в поиске скрытых паттернов и тенденций, которые помогают нам принимать решения, основанные на данных.

На этом уроке вы погрузитесь глубже в последние шаги процесса анализа данных.

Запросы данных невероятно полезны для извлечения информации из данных и ответов на вопросы.

![sales](https://lecontent.sololearn.com/material-images/f8e6f02ccc964a48b59aad34c0309ab3-Frame27184.png)

Нижеследующий код, находит самый продаваемый продукт в июне:
```sql
SELECT product, SUM(qty)
FROM sales
WHERE month = 'June'
GROUP BY product
```
> CREATE TABLE
> 
> INSERT 0 7
> 
> |product	|sum|
> |-----|-----|
> |Chicken breasts|	8|
> |Coffee	|5|
> |Milk	|5|
> (3 rows)

Первые четыре шага в процессе анализа данных:

1. Задать вопрос
2. Собрать данные
3. Очистить данные
4. Извлечь информацию

Результатом операции сравнения всегда является логическое значение. Для The Hobbit и A Game of Thrones - условие в нижеприведенной таблице **верно**:

![books](https://lecontent.sololearn.com/material-images/0d376f3c9c6e4212be095d0528b66d4d-sense1.png)

Булевы значения помогают вам писать более сложные и эффективные запросы для ответов на вопросы о данных. Операции с булевыми значениями называются логическими операциями.

**Булево значение** - это тип данных с двумя значениями: **True** (правда) или **False** (ложь).

**Логическая операция** принимает несколько булевых значений и производит одно логическое значение.

![logical](https://lecontent.sololearn.com/material-images/3922db109a9b46449da04262095e8a1c-Frame27166.png)

Результатом операции **AND** является значение **True** только тогда, когда все значения одновременно **True**. Результатом
```sql
True AND True 
```
будет - `True`.

Вы можете использовать логические операции для фильтрации данных, которые соответствуют нескольким условиям. Так как операция AND дает значение True только тогда, когда все условия True:

![books](https://lecontent.sololearn.com/material-images/8270fe596a8d483385021f8c77640762-Frame.27142.png)

```sql
SELECT title
FROM books
WHERE qty >= 5 AND year > 1950
```
> CREATE TABLE
> 
> INSERT 0 4
> 
> |title
> |-----
> |A Game of Thrones
> (1 row)
---
![AND](https://lecontent.sololearn.com/material-images/f3aadf1b0f254c9b9c4583e42d806694-Frame27192.png)

- `False AND False` -> False  
- `False AND True` -> False
- `True AND False` -> False
- `True AND True` -> True

![deliveries](https://lecontent.sololearn.com/material-images/850a1c36566945bf8e0aa1de4e742f5d-4.06.12.png)

На изображении выше - первый и пятый `id` будут соответствовать нескольким условиям в запросе.

![orders](https://lecontent.sololearn.com/material-images/fa54720c7e734af384939f80295dd673-4.06.13.png)

Запрос: получить `id` заказов, которые были `delivered` в `USA`:
```sql
SELECT id
FROM orders
WHERE status = 'Delivered' AND country = 'USA';
```

Логическая операция **OR** дает результат **True**, если хотя бы одно из условий **True**.

Результатом
```sql
True OR False
```
будет `True`.

![or](https://lecontent.sololearn.com/material-images/887e49a38f744ccb8690e0238a8ded4c-4.06.15.png)

- False OR False -> False
- False OR True -> True
- True OR False -> True
- True OR True -> True

![books](https://lecontent.sololearn.com/material-images/3dfede5454654f5eb9cfa17d24993447-4.06.17.png)

Из вышеприведенной таблицы будут извлечены Harry Potter и The Lord of Rings.

Запрос: получить продукты из категорий `Clothing` или `Shoes`
```sql
SELECT *
FROM products
WHERE category = 'Clothing' OR category = 'Shoes';
```

Запрос: получить пользователя с именем пользователя `ann88` или номером телефона `854930340`
```sql
SELECT *
FROM users
WHERE p_number = 854930340
OR username = 'ann88';
```

**Визуализация данных** помогает выявлять тенденции и паттерны в ваших данных. Язык программирования, такой как Python, позволяет создавать мощные визуальные средства для передачи ваших результатов! Совершенный следующий шаг для дополнения ваших новых навыков SQL!

![communicate](https://lecontent.sololearn.com/material-images/c80613ebcef443f58db957b45d6d3a7a-Frame27180.png)

Последний этап процесса анализа данных - это передача ваших результатов. Здесь вам пригодятся навыки коммуникации. На этом этапе визуализация данных и рассказы о данных помогут вам превратить инсайты в действия.

---
Поздравляем! Вы завершили уроки по SQL! 🎉

Потребность компаний в использовании данных означает, что специалисты по данным в огромном спросе. Теперь вы знаете, как использовать стандартизированный язык баз данных SQL для доступа и манипулирования данными, хранящимися в базах данных!

 

Продолжайте учиться, расти и развиваться! 🚀

### [Назад к оглавлению](#back)


<a id="exam_4"></a>
Контрольные вопросы к модулю 4
---

```sql
1.
Первый шаг анализа данных - это…

[] очищать данные
[] собирать данные
[x] задавать вопросы
```
2.
![movies](https://lecontent.sololearn.com/material-images/7c7686fe387743dd97fb051abb2ece28-Frame272001).png)

```sql
Какая проблема качества данных у нас здесь?

[x] Дублирование данных
[] Неверный тип данных
[] Отсутствующие значения
```
3.
![orders](https://lecontent.sololearn.com/material-images/227a5d9bd18c459b8b800407d5f9449c-MQ4,lp3.png)

Завершите для извлечения выбранных значений
```sql
SELECT country
FROM orders
WHERE status = 'Delivered"
```

4.
![products](https://lecontent.sololearn.com/material-images/14004ab5ceb6468cb5480f300dbbe1f4-Frame7178(1).png)

Сколько наименований продуктов будет извлечено?

- [ ] 2
- [x] 3
- [ ] 5

5.
```sql
SELECT *
FROM employees
WHERE salary > 5000  department = 'Marketing';
```
Этот код содержит ошибку, вы можете её идентифицировать?

- [ ] Число 5000 должно быть заключено в кавычки
- [x] Логический оператор отсутствует
- [ ] Символ * должен быть заменён на #

6.
Выберите все правильные способы сбора данных
- [x] Использование API
- [x] Сбор информации с веб страниц
- [x] Запрос к базе данных

7.
Завершите для извлечения уникальных категорий продуктов
```sql
SELECT DISTINCT category
FROM products
```

8.
![patients](https://lecontent.sololearn.com/material-images/4d9443237bd84e30b4098315c176562d-Frame27177(3).png)

Что извлечет этот запрос?
- [x] Frodo Baggins
- [x] Oliver Twist
- [ ] Atticus Finch
- [ ] Jay Gatsby

9.
![sales](https://lecontent.sololearn.com/material-images/cd11c0f309984560a4e41e778c2e725c-Frame27197.png)

Извлеките выбранную запись из таблицы
```sql
SELECT *
FROM sales
WHERE product = 'Coffee' AND qty = 5
```

10.
Переставьте следующие шаги в процессе анализа данных для понимания поведения пользователей на веб-сайте:
- Задать вопрос
- Собрать данные
- Очистить данные
- Извлеч информацию

### [Назад к оглавлению](#back)

**Поздравляем!** 

Курс закончен, вы получили сертификат **Introduction to SQL**.

- Тут и сказочке конец. 'aliadm